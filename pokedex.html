<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Pokédex</title>

  <!-- Estilo oficial da Pokémon -->
  <link rel="stylesheet" href="https://assets.pokemon.com/static2/_ui/css/main.css" />
  <link href="//fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet" type="text/css" />

  <!-- CSS externo correto -->
  <link rel="stylesheet" href="pokemon.css" />
</head>
<body>

  <header>
    <nav>
      <a href="#">Pokédex</a>
    </nav>
  </header>

  <main>
    <h1>Bem-vindo à Pokédex!</h1>
    <p>Explore o mundo dos Pokémon com informações detalhadas sobre todos eles.</p>

    <div id="search-section">
      <div class="search-controls">
        <input type="text" id="pokemon-input" placeholder="Digite o nome ou número do Pokémon" />
        <button id="search-button">Buscar</button>
        <select id="generation-select">
          <option value="">--Geração--</option>
          <option value="1">Kanto (Geração 1)</option>
          <option value="2">Johto (Geração 2)</option>
          <option value="3">Hoenn (Geração 3)</option>
          <option value="4">Sinnoh (Geração 4)</option>
          <option value="5">Unova (Geração 5)</option>
          <option value="6">Kalos (Geração 6)</option>
          <option value="7">Alola (Geração 7)</option>
          <option value="8">Galar (Geração 8)</option>
          <option value="9">Paldea (Geração 9)</option>
        </select>
      </div>
      <div id="season-pokemon-list" class="pokemon-grid"></div>
    </div>

    <div id="pokemon-info"></div>
  </main>

  <div id="pokemon-modal">
    <div class="modal-content">
      <span id="modal-close" class="close">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>

  <script>
   const button = document.getElementById('search-button');
    const input = document.getElementById('pokemon-input');
    const infoDiv = doument.getElementById('pokemon-info');

    const modal = document.getElementById('pokemon-modal');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');

    async function fetchPokemon(nameOrNumber) {
      try {
        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${nameOrNumber.toLowerCase().trim()}`);
        if (!response.ok) throw new Error('Pokémon não encontrado.');
        const data = await response.json();

        modalBody.innerHTML = `
          <div class="pokemon-card">
            <h2>${data.name} (#${data.id})</h2>
            <img src="${data.sprites.other['official-artwork'].front_default}" alt="${data.name}" />
            <div class="types">
              ${data.types.map(t => `<span class="type">${t.type.name}</span>`).join('')}
            </div>
            <p><strong>Altura:</strong> ${(data.height / 10).toFixed(1)} m</p>
            <p><strong>Peso:</strong> ${(data.weight / 10).toFixed(1)} kg</p>
            <p><strong>Habilidades:</strong> ${data.abilities.map(a => a.ability.name).join(', ')}</p>
            <h3>Status base:</h3>
            <ul>
              ${data.stats.map(s => `<li>${s.stat.name}: ${s.base_stat}</li>`).join('')}
            </ul>
          </div>
        `;

        modal.style.display = 'block';
      } catch (error) {
        infoDiv.innerHTML = `<p style="color:red;">${error.message}</p>`;
      }
    }

    button.addEventListener('click', () => {
      const val = input.value.trim();
      if (!val) return alert('Digite o nome ou número de um Pokémon.');
      fetchPokemon(val);
      highlightSearchedCard(val);
    });

    modalClose.addEventListener('click', () => modal.style.display = 'none');
    window.addEventListener('click', e => {
      if (e.target === modal) modal.style.display = 'none';
    });

    const generationSelect = document.getElementById('generation-select');
    const seasonPokemonList = document.getElementById('season-pokemon-list');

    generationSelect.addEventListener('change', async () => {
      const generation = generationSelect.value;
      if (!generation) {
        seasonPokemonList.innerHTML = '';
        return;
      }

      try {
        const response = await fetch(`https://pokeapi.co/api/v2/generation/${generation}`);
        const data = await response.json();

        const pokemons = data.pokemon_species.sort((a, b) => a.name.localeCompare(b.name));
        seasonPokemonList.innerHTML = pokemons.map(pokemon => {
          const id = pokemon.url.split('/').filter(Boolean).pop();
          const image = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${id}.png`;
          return `
            <div class="pokemon-card" onclick="fetchPokemon('${pokemon.name}')">
              <img src="${image}" alt="${pokemon.name}" />
              <p>${pokemon.name}</p>
            </div>
          `;
        }).join('');

        removeAllActiveClasses();

      } catch (err) {
        seasonPokemonList.innerHTML = `<p style="color:red;">Erro ao carregar geração.</p>`;
      }
    });

    // Adiciona toggle para destacar o card clicado
    seasonPokemonList.addEventListener('click', e => {
      const card = e.target.closest('.pokemon-card');
      if (!card) return;
      card.classList.toggle('active');
    });

    // Destaca cards que batem com a busca
    function highlightSearchedCard(term) {
      const cards = document.querySelectorAll('.pokemon-card');
      const search = term.toLowerCase().trim();

      cards.forEach(card => {
        const name = card.querySelector('p')?.textContent.toLowerCase() || '';
        if (name.includes(search)) {
          card.classList.add('active');
        } else {
          card.classList.remove('active');
        }
      });
    }

    // Remove destaque de todos os cards (usado ao trocar de geração)
    function removeAllActiveClasses() {
      const cards = document.querySelectorAll('.pokemon-card');
      cards.forEach(card => card.classList.remove('active'));
    }
  </script>
</body>
</html>